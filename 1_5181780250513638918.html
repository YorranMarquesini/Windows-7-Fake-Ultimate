<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Windows 7 Fake Ultimate</title>

<style>
html,body{
  margin:0;width:100%;height:100%;
  font-family:Segoe UI;background:black;
  user-select:none
}

/* BOOT */
#boot{
  position:fixed;inset:0;
  background:black;color:white;
  display:flex;align-items:center;justify-content:center;
  flex-direction:column;z-index:9999
}

/* DESKTOP */
#desktop{
  width:100%;height:100%;
  background:linear-gradient(120deg,#0a3d62,#1e90ff);
  display:none;position:relative;overflow:hidden
}

/* ICONES */
.icon{
  width:72px;text-align:center;color:white;
  margin:15px;cursor:default;
}
.icon.selected{
  background:rgba(0,120,215,.4);
  border:1px solid rgba(255,255,255,.6)
}
.icon img{width:48px}
.icon span{font-size:12px}

/* SELECTION BOX */
#selectBox{
  position:absolute;
  border:1px dashed #3399ff;
  background:rgba(51,153,255,.2);
  display:none;
  pointer-events:none;
  z-index:2000
}

/* TASKBAR */
#taskbar{
  position:absolute;
  bottom:0;width:100%;height:48px; /* um pouco mais alta */
  background:rgba(30,30,30,0.9); /* mais escura e s√≥lida */
  display:flex;align-items:center;padding:0 8px;
  box-shadow:0 -2px 10px rgba(0,0,0,0.5);
  backdrop-filter: blur(5px); /* efeito moderno */
  border-top:1px solid rgba(255,255,255,0.1);
  z-index:1000;
}

#taskbar-apps {
  display:flex;
  gap:6px;
  margin-left:8px;
  overflow-x:auto; /* caso tenha muitos apps */
}

.taskbar-btn {
  background:rgba(255,255,255,0.1);
  color:white;
  padding:4px 10px;
  border-radius:6px;
  cursor:pointer;
  height:32px;
  display:flex;
  align-items:center;
  font-size:13px;
  font-weight:500;
  transition:all 0.15s ease;
  white-space:nowrap; /* n√£o quebra o texto */
}
.taskbar-btn:hover {
  background:linear-gradient(90deg,#3498db,#2980b9);
  color:white;
  box-shadow:0 2px 8px rgba(0,0,0,0.4);
  transform:translateY(-2px);
}

#start{
  width:100px;height:36px;
  background:linear-gradient(135deg,#2ecc71,#27ae60);
  color:white;font-weight:bold;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  border-radius:6px;
  box-shadow:0 2px 5px rgba(0,0,0,0.3);
  transition:all 0.2s ease;
}
#start:hover{
  background:linear-gradient(135deg,#27ae60,#2ecc71);
  transform:translateY(-1px);
}

.task-btn{
  background:rgba(255,255,255,.15);
  color:white;padding:6px 10px;
  margin-left:4px;font-size:13px;
  cursor:pointer;border-radius:3px
}

#clock{
  margin-left:auto;
  margin-right:15px;
  color:white;
  font-weight:bold;
  font-family:Consolas, monospace;
  font-size:14px;
}

/* START MENU */
#start-menu{
  position:absolute;bottom:42px;left:0;
  width:240px;height:300px;
  background:#ecf0f1;display:none
}
.start-item{padding:10px;cursor:pointer}
.start-item:hover{background:#3498db;color:white}

/* WINDOWS */
.window{
  width:420px;height:280px;
  background:#ecf0f1;position:absolute;
  border-radius:6px;overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.4)
}
.title{
  height:32px;background:linear-gradient(#3498db,#2980b9);
  color:white;display:flex;align-items:center;
  padding:0 8px;cursor:move
}
.title span{margin-left:8px;cursor:pointer}
.content{padding:10px;height:calc(100% - 32px)}

textarea{
  width:100%;height:100%;
  border:none;resize:none;
  outline:none;font-family:Consolas
}
canvas{display:block;margin:auto}
</style>
</head>

<body>

<div id="boot">
  <h2>Iniciando Windows 7</h2>
  <span>Carregando...</span>
</div>

<div id="desktop">
  <div id="selectBox"></div>

  <div class="icon" data-app="explorer">
    <img src="https://img.icons8.com/fluency/48/folder-invoices.png">
    <span>Arquivos</span>
  </div>

  <div class="icon" data-app="notepad">
    <img src="https://img.icons8.com/fluency/48/notepad.png">
    <span>Bloco de Notas</span>
  </div>
  
  <div class="icon" data-app="browser">
  <img src="https://img.icons8.com/fluency/48/internet--v1.png">
  <span>Navegador</span>
  </div>


  <div id="start-menu">
    <div class="start-item" onclick="openExplorer()">Explorador</div>
    <div class="start-item" onclick="openNotepad()">Bloco de Notas</div>
    <div class="start-item" onclick="openSnake()">Snake üêç</div>
    <div class="start-item" onclick="openMines()">Campo Minado üí£</div>
    <div class="start-item" onclick="openPong()">Pong üèì</div>
	<div class="start-item" onclick="openBrowser()">Navegador</div>
  </div>

  <div id="taskbar">
  <div id="start">Iniciar</div>
  <div id="taskbar-apps"></div> <!-- Aqui v√£o os apps minimizados -->
  <div id="clock"></div>
  </div>
</div>

<script>
const boot = document.getElementById("boot");
const desktop = document.getElementById("desktop");
const clock = document.getElementById("clock");
const startMenu = document.getElementById("start-menu");
const startBtn = document.getElementById("start");
const selectBox = document.getElementById("selectBox");

/* BOOT */
setTimeout(()=>{ boot.style.display="none"; desktop.style.display="block"; },2000);

/* CLOCK */
setInterval(()=>{ clock.textContent=new Date().toLocaleTimeString().slice(0,5); },1000);

/* START */
startBtn.onclick=()=>{ startMenu.style.display = startMenu.style.display==="block"?"none":"block"; };

/* SELE√á√ÉO */
let selecting=false,sx=0,sy=0;
desktop.addEventListener("mousedown",e=>{ if(e.target!==desktop)return; selecting=true; sx=e.clientX; sy=e.clientY; selectBox.style.display="block"; });
document.addEventListener("mousemove",e=>{ if(!selecting)return; const x=Math.min(e.clientX,sx), y=Math.min(e.clientY,sy), w=Math.abs(e.clientX-sx), h=Math.abs(e.clientY-sy); Object.assign(selectBox.style,{left:x+"px",top:y+"px",width:w+"px",height:h+"px"}); });
document.addEventListener("mouseup",()=>{ selecting=false; selectBox.style.display="none"; });
let z = 10; // controle de profundidade das janelas
let mem = "Digite algo..."; // mem√≥ria inicial para apps

/* FUN√á√ÉO PARA CRIAR JANELAS */
function createWindow(title, html, onOpen) {
  startMenu.style.display = "none";

  const w = document.createElement("div");
  w.className = "window";

  // Tamanhos ideais por app
  let width = 560, height = 400; // padr√£o
  if(title.includes("Bloco de Notas")) { width=650; height=400; }
  if(title.includes("Explorador")) { width=500; height=350; }
  if(title.includes("Campo Minado üí£")) { width=750; height=550; }

  w.style.width = width + "px";
  w.style.height = height + "px";

  // posi√ß√£o inicial aleat√≥ria
  w.style.top = Math.random() * 200 + 80 + "px";
  w.style.left = Math.random() * 300 + 120 + "px";
  w.style.zIndex = ++z;

  // conte√∫do da janela
  w.innerHTML = `
  <div class="title">
    <span class="title-text">${title}</span>
    <div class="buttons">
      <span class="min">_</span>
      <span class="close">X</span>
    </div>
  </div>
  <div class="content" style="height: calc(100% - 32px); overflow:auto;">${html}</div>
`;

  desktop.appendChild(w);

  // bot√£o fechar
  w.querySelector(".close").onclick = () => w.remove();

  // bot√£o minimizar
  const taskbarApps = document.getElementById("taskbar-apps");
  w.querySelector(".min").onclick = () => {
  w.style.display = "none";

  // Criar bot√£o na taskbar
  const btn = document.createElement("div");
  btn.className = "taskbar-btn";
  btn.textContent = title;

  // Restaurar janela ao clicar
  btn.onclick = () => {
    w.style.display = "block";
    w.style.zIndex = ++z;
    btn.remove(); // remove o bot√£o da taskbar
  };

  taskbarApps.appendChild(btn);
};

  // arrastar janela
  let dragging = false, ox, oy;
  const titleBar = w.querySelector(".title");
  titleBar.onmousedown = e => {
    dragging = true;
    w.style.zIndex = ++z;
    ox = e.clientX - w.offsetLeft;
    oy = e.clientY - w.offsetTop;
  };
  document.onmousemove = e => {
    if(dragging) {
      w.style.left = e.clientX - ox + "px";
      w.style.top = e.clientY - oy + "px";
    }
  };
  document.onmouseup = () => dragging = false;

  if(onOpen) onOpen(w);

  return w; // retorna a janela criada
}

/* APP: BLOCO DE NOTAS */
function openNotepad() {
  createWindow("Bloco de Notas",
    `
    <style>
      /* Textarea estilizado */
      #notepadArea {
        width: 100%;
        height: calc(100% - 50px);
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-family: Consolas, monospace;
        font-size: 14px;
        resize: none;
        outline: none;
        box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        background: #fafafa;
        transition: all 0.2s ease;
      }
      #notepadArea:focus {
        box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
      }

      /* Container dos bot√µes */
      .notepad-buttons {
        margin-top: 8px;
        display: flex;
        justify-content: flex-end;
        gap: 6px;
      }

      /* Bot√µes */
      .notepad-btn {
        background: #3498db;
        color: white;
        border: none;
        padding: 6px 14px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.2s ease;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      }

      .notepad-btn:hover {
        background: #2980b9;
        transform: translateY(-1px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      }

      .notepad-btn.clear {
        background: #e74c3c;
      }

      .notepad-btn.clear:hover {
        background: #c0392b;
      }
    </style>

    <textarea id="notepadArea">${localStorage.getItem("notepadContent")||""}</textarea>
    <div class="notepad-buttons">
      <button id="saveNote" class="notepad-btn">üíæ Salvar</button>
      <button id="clearNote" class="notepad-btn clear">üóë Limpar</button>
    </div>
    `,
    w => {
      const ta = w.querySelector("#notepadArea");
      const saveBtn = w.querySelector("#saveNote");
      const clearBtn = w.querySelector("#clearNote");

      saveBtn.onclick = () => {
        localStorage.setItem("notepadContent", ta.value);
        alert("Nota salva!");
      };

      clearBtn.onclick = () => {
        ta.value = "";
        localStorage.removeItem("notepadContent");
      };
    }
  );
}

/* SISTEMA DE ARQUIVOS SIMULADO */
const fileSystem = {
  "Desktop": {
    "Documentos": {
      "arquivo1.txt": "Conte√∫do do arquivo 1",
      "arquivo2.txt": "Conte√∫do do arquivo 2"
    },
    "Downloads": {},
    "Imagens": {}
  }
};

/* APP: EXPLORADOR DE ARQUIVOS FUNCIONAL */
function openExplorer(currentPath = ["Desktop"]) {
  createWindow("Explorador",
    `<div id="path" style="font-size:12px; margin-bottom:5px; font-weight:bold; color:black;"></div>
     <div id="fileArea"></div>`,
    w => {
      const pathDiv = w.querySelector("#path");
      const fileArea = w.querySelector("#fileArea");

      function renderPath() {
        pathDiv.innerHTML = "";
        currentPath.forEach((p, i) => {
          const span = document.createElement("span");
          span.textContent = p;
          span.onclick = () => {
            currentPath = currentPath.slice(0, i + 1);
            renderFiles();
          };
          pathDiv.appendChild(span);
        });
      }

      function renderFiles() {
        fileArea.innerHTML = "";
        let node = fileSystem;
        currentPath.forEach(p => node = node[p]);

        for (const name in node) {
          const isFolder = typeof node[name] === "object";
          const icon = document.createElement("div");
          icon.className = "icon";
          icon.innerHTML = `<img src="${isFolder ? 'https://img.icons8.com/fluency/48/folder-invoices.png':'https://img.icons8.com/fluency/48/document.png'}"><span>${name}</span>`;
          fileArea.appendChild(icon);

          icon.onclick = () => {
            if (isFolder) {
              currentPath.push(name);
              renderFiles();
            } else if (name.endsWith(".txt")) {
              const content = node[name];
              createWindow("Bloco de Notas - " + name,
                `<textarea>${content}</textarea>
                 <div style="margin-top:5px; text-align:right;">
                   <button id="saveFile">üíæ Salvar</button>
                 </div>`,
                win => {
                  const ta = win.querySelector("textarea");
                  const saveBtn = win.querySelector("#saveFile");
                  saveBtn.onclick = () => {
                    node[name] = ta.value;
                    alert("Arquivo salvo!");
                  };
                }
              );
            }
          };
        }

        renderPath();
      }

      // Clique com bot√£o direito para criar nova pasta
      fileArea.oncontextmenu = (e) => {
        e.preventDefault();
        let node = fileSystem;
        currentPath.forEach(p => node = node[p]);

        const folderNameBase = "Nova Pasta";
        let i = 1;
        let folderName = folderNameBase;
        while (node[folderName]) {
          folderName = folderNameBase + " " + i;
          i++;
        }

        node[folderName] = {};

        // Criar √≠cone edit√°vel
        // Criar √≠cone edit√°vel
const icon = document.createElement("div");
icon.className = "icon";
icon.innerHTML = `<img src='https://img.icons8.com/fluency/48/folder-invoices.png'><input value='${folderName}'>`;
fileArea.appendChild(icon);

const input = icon.querySelector("input");
input.focus();
input.select();

function setFolderName() {
  const newName = input.value.trim();
  if (!newName || (node[newName] && newName !== folderName)) {
    delete node[folderName]; // remove se inv√°lido
    icon.remove();
  } else {
    node[newName] = node[folderName]; // renomeia
    if (newName !== folderName) delete node[folderName];
    icon.innerHTML = `<img src='https://img.icons8.com/fluency/48/folder-invoices.png'><span>${newName}</span>`;
    renderFiles(); // atualizar interface
  }
}

// Aplica tanto no blur quanto no Enter
input.onblur = setFolderName;
input.onkeydown = (e) => {
  if (e.key === "Enter") {
    setFolderName();
  }
};
      };

      renderFiles();
    }
  );
}

/* SELE√á√ÉO E ABERTURA DE ICONES DESKTOP */
const appActions = {
  explorer: openExplorer,
  notepad: openNotepad,
  browser: openBrowser // <- adicione o navegador aqui
};

document.querySelectorAll(".icon").forEach(icon => {
  let clickTimer = null;

  icon.onclick = e => {
    e.stopPropagation();

    document.querySelectorAll(".icon").forEach(i => i.classList.remove("selected"));
    icon.classList.add("selected");

    if(clickTimer) {
      clearTimeout(clickTimer);
      clickTimer = null;

      const app = icon.dataset.app;
      if(appActions[app]) appActions[app]();

    } else {
      clickTimer = setTimeout(() => clickTimer = null, 250);
    }
  };
});

desktop.onclick = e => {
  if(e.target === desktop) {
    document.querySelectorAll(".icon").forEach(i => i.classList.remove("selected"));
  }
};

/* APP: EXPLORADOR */
function openBrowser() {
  createWindow("Navegador",
  `
  <style>
    .browser-bar {
      display: flex;
      gap: 5px;
      padding: 5px;
      background: #f0f0f0;
      border-bottom: 1px solid #ccc;
      align-items: center;
    }
    .browser-bar input {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      outline: none;
      font-size: 14px;
    }
    .browser-bar button {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: #3498db;
      color: white;
      transition: all 0.2s;
    }
    .browser-bar button:hover { background: #2980b9; }

    .browser-iframe {
      width: 100%;
      height: calc(100% - 42px);
      border: none;
      background: white;
    }

    .browser-msg {
      padding: 10px;
      font-size: 12px;
      color: #555;
    }

    .favorites-bar {
      display: flex;
      gap: 5px;
      padding: 5px;
      background: #e0e0e0;
      border-bottom: 1px solid #ccc;
      overflow-x: auto;
    }
    .favorite-btn {
      padding: 4px 8px;
      background: #3498db;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      white-space: nowrap;
    }
    .favorite-btn:hover { background: #2980b9; }
  </style>

  <div class="browser-bar">
    <button id="backBtn">‚óÄ</button>
    <button id="forwardBtn">‚ñ∂</button>
    <button id="reloadBtn">‚ü≥</button>
    <input type="text" id="browserInput" placeholder="Digite URL ou pesquisa">
    <button id="goBtn">üîç</button>
    <button id="favBtn">‚≠ê</button>
  </div>
  <div class="favorites-bar" id="favoritesBar"></div>
  <iframe id="browserFrame" class="browser-iframe" srcdoc="<p style='text-align:center; margin-top:50px; font-size:16px;'>Bem-vindo ao navegador do seu desktop!</p>"></iframe>
  <div class="browser-msg" id="browserMsg">Digite uma URL ou pesquisa e pressione Enter / üîç</div>
  `,
  w => {
    const input = w.querySelector("#browserInput");
    const iframe = w.querySelector("#browserFrame");
    const backBtn = w.querySelector("#backBtn");
    const forwardBtn = w.querySelector("#forwardBtn");
    const reloadBtn = w.querySelector("#reloadBtn");
    const goBtn = w.querySelector("#goBtn");
    const favBtn = w.querySelector("#favBtn");
    const favoritesBar = w.querySelector("#favoritesBar");
    const msg = w.querySelector("#browserMsg");

    let historyStack = [];
    let historyIndex = -1;
    let favorites = [];

    function updateButtons() {
      backBtn.disabled = historyIndex <= 0;
      forwardBtn.disabled = historyIndex >= historyStack.length - 1;
    }

    function navigate(url) {
      if (!url) return;

      // Transformar pesquisa em URL
      if(!/^https?:\/\//i.test(url)) {
        if(/\s/.test(url)) {
          url = "https://www.google.com/search?q=" + encodeURIComponent(url);
        } else {
          url = "https://" + url;
        }
      }

      // Adicionar ao hist√≥rico
      historyStack = historyStack.slice(0, historyIndex+1);
      historyStack.push(url);
      historyIndex++;

      iframe.src = url;
      input.value = url;
      msg.textContent = "Carregando: " + url;

      updateButtons();
    }

    // Bot√µes
    backBtn.onclick = () => {
      if(historyIndex > 0) {
        historyIndex--;
        iframe.src = historyStack[historyIndex];
        input.value = historyStack[historyIndex];
        msg.textContent = "Carregando: " + historyStack[historyIndex];
        updateButtons();
      }
    };

    forwardBtn.onclick = () => {
      if(historyIndex < historyStack.length-1) {
        historyIndex++;
        iframe.src = historyStack[historyIndex];
        input.value = historyStack[historyIndex];
        msg.textContent = "Carregando: " + historyStack[historyIndex];
        updateButtons();
      }
    };

    reloadBtn.onclick = () => {
      if(historyIndex >= 0) iframe.src = historyStack[historyIndex];
    };

    goBtn.onclick = () => navigate(input.value);
    input.onkeydown = e => { if(e.key === "Enter") navigate(input.value); };

    // Favoritos
    function renderFavorites() {
      favoritesBar.innerHTML = "";
      favorites.forEach(url => {
        const btn = document.createElement("div");
        btn.className = "favorite-btn";
        btn.textContent = url;
        btn.onclick = () => navigate(url);
        favoritesBar.appendChild(btn);
      });
    }

    favBtn.onclick = () => {
      if(historyIndex >= 0) {
        const url = historyStack[historyIndex];
        if(!favorites.includes(url)) favorites.push(url);
        renderFavorites();
      }
    };

    // Mensagem quando iframe n√£o carrega
    iframe.onerror = () => {
      msg.textContent = "N√£o foi poss√≠vel carregar o site. Talvez o site bloqueie iframe.";
    }

    updateButtons();
    renderFavorites();
  });
}

/* JOGO: SNAKE üêç */
function openSnake() {
  createWindow("Snake üêç",
    `<div style="text-align:right; font-size:12px; margin-bottom:5px;">
       Highscore: <span id="highscore">0</span>
     </div>
     <canvas id="snakeCanvas" width="300" height="300" style="background:#111; display:block; margin:auto; border-radius:8px;"></canvas>

     <!-- Menu Central -->
     <div id="menuContainer" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); display:flex; flex-direction:column; align-items:center; gap:15px;">
       <button id="startBtn" class="game-btn" style="display:inline-block;">Start</button>
       <button id="retryBtn" class="game-btn" style="display:none;">Tentar Novamente</button>
       <div id="lastScore" style="font-size:16px; color:white;"></div>
     </div>

     <style>
       .game-btn {
         font-size:20px;
         padding:10px 25px;
         border:none;
         border-radius:8px;
         background:linear-gradient(135deg,#27ae60,#2ecc71);
         color:white;
         cursor:pointer;
         box-shadow:0 4px #1e8449;
         transition: all 0.2s ease;
       }
       .game-btn:hover { background:linear-gradient(135deg,#2ecc71,#27ae60); }
       .game-btn:active { transform:translateY(2px); box-shadow:0 2px #1e8449; }
     </style>`,
    w => {
      const canvas = w.querySelector("#snakeCanvas");
      const ctx = canvas.getContext("2d");
      const highscoreEl = w.querySelector("#highscore");
      const startBtn = w.querySelector("#startBtn");
      const retryBtn = w.querySelector("#retryBtn");
      const lastScoreEl = w.querySelector("#lastScore");
      const menuContainer = w.querySelector("#menuContainer");

      const grid = 15;
      let count = 0;
      let snake, dx, dy, food, score, gameRunning;
      let highscore = 0;
      let hasStartedOnce = false;

      function initGame() {
        snake = [{x: 5*grid, y: 5*grid}];
        dx = grid; dy = 0;
        food = {x: Math.floor(Math.random()*20)*grid, y: Math.floor(Math.random()*20)*grid};
        score = 0;
        gameRunning = false;

        drawBackground();
        drawFood();
      }

      function drawBackground() {
        ctx.fillStyle = "#111";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // grade leve
        ctx.strokeStyle = "#222";
        ctx.lineWidth = 1;
        for(let x=0;x<=canvas.width;x+=grid){
          ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke();
        }
        for(let y=0;y<=canvas.height;y+=grid){
          ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke();
        }
      }

      function drawSnake() {
        for(let i=0;i<snake.length;i++){
          const s = snake[i];
          const green = 200 - (i*8); // degrad√™
          const red = i*5;
          ctx.fillStyle = `rgb(${red},${green},0)`;
          ctx.fillRect(s.x,s.y,grid-1,grid-1);
        }
      }

      function drawFood() {
        ctx.fillStyle = "red";
        ctx.shadowColor = "orange";
        ctx.shadowBlur = 8;
        ctx.fillRect(food.x, food.y, grid-1, grid-1);
        ctx.shadowBlur = 0;
      }

      function gameLoop() {
        if (!gameRunning) return;
        if (++count < 6) { requestAnimationFrame(gameLoop); return; }
        count = 0;

        drawBackground();

        const head = {x: snake[0].x + dx, y: snake[0].y + dy};

        // colis√£o
        if(head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height ||
           snake.some(s => s.x === head.x && s.y === head.y)) {
          gameRunning = false;
          lastScoreEl.textContent = `Score: ${score}`;
          if(score > highscore) { highscore = score; highscoreEl.textContent = highscore; }
          retryBtn.style.display = "inline-block";
          menuContainer.style.display = "flex";
          return;
        }

        snake.unshift(head);

        if(head.x === food.x && head.y === food.y){
          score++;
          food.x = Math.floor(Math.random()*20)*grid;
          food.y = Math.floor(Math.random()*20)*grid;
        } else {
          snake.pop();
        }

        drawSnake();
        drawFood();

        requestAnimationFrame(gameLoop);
      }

      document.onkeydown = e => {
        if (!gameRunning) return;
        if(e.key === "ArrowUp" && dy === 0) { dx=0; dy=-grid; }
        if(e.key === "ArrowDown" && dy === 0) { dx=0; dy=grid; }
        if(e.key === "ArrowLeft" && dx === 0) { dx=-grid; dy=0; }
        if(e.key === "ArrowRight" && dx === 0) { dx=grid; dy=0; }
      };

      function startCountdown(callback) {
        const overlay = document.createElement("div");
        overlay.style.position = "absolute";
        overlay.style.top = 0;
        overlay.style.left = 0;
        overlay.style.width = "100%";
        overlay.style.height = "100%";
        overlay.style.background = "rgba(0,0,0,0.7)";
        overlay.style.color = "white";
        overlay.style.fontSize = "72px";
        overlay.style.fontWeight = "bold";
        overlay.style.display = "flex";
        overlay.style.alignItems = "center";
        overlay.style.justifyContent = "center";
        overlay.style.zIndex = 10;
        overlay.style.opacity = 0;
        overlay.style.transition = "opacity 0.3s ease, transform 0.3s ease";
        w.appendChild(overlay);

        let num = 3;

        function showNext() {
          if(num < 0){ w.removeChild(overlay); callback(); return; }
          overlay.textContent = num > 0 ? num : "Go!";
          overlay.style.opacity = 1;
          overlay.style.transform = "scale(1.3)";
          setTimeout(()=> { overlay.style.opacity=0; overlay.style.transform="scale(1)"; }, 600);
          num--;
          setTimeout(showNext, 800);
        }
        showNext();
      }

      function startGame() {
        hasStartedOnce = true;
        menuContainer.style.display = "none";
        startBtn.style.display = "none";
        retryBtn.style.display = "none";
        lastScoreEl.textContent = "";
        initGame();
        startCountdown(()=>{ gameRunning=true; requestAnimationFrame(gameLoop); });
      }

      startBtn.onclick = startGame;

      retryBtn.onclick = ()=>{
        if(!hasStartedOnce) return;
        menuContainer.style.display="flex";
        startBtn.style.display="inline-block";
        retryBtn.style.display="none";
        lastScoreEl.textContent="";
      };
    }
  );
}

/* JOGO: CAMPO MINADO üí£ */
function openMines(rows = 9, cols = 9, minesCount = 10) {
  createWindow("Campo Minado üí£",
    `<div id="mineMenu" style="display:flex; flex-direction:column; align-items:center; gap:10px; margin-bottom:10px;">
        <div>Minas restantes: <span id="mineCount">${minesCount}</span></div>
     </div>
     <div style="position:relative; display:flex; justify-content:center; align-items:center;">
       <canvas id="mineCanvas" width="${cols*50}" height="${rows*50}" style="background:#f5f5f5; border-radius:12px;"></canvas>
       <div id="endMessage" style="display:none; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); 
          background:white; padding:25px 40px; border-radius:16px; text-align:center; font-size:24px; font-weight:bold; color:black; 
          z-index:100; box-shadow: 0 8px 20px rgba(0,0,0,0.2);">
          <span id="resultText"></span><br><br>
          <button id="resetBtn" class="game-btn">üîÑ Reset</button>
       </div>
     </div>
     <style>
        .game-btn {
          font-size:18px;
          padding:12px 25px;
          border:none;
          border-radius:14px;
          background:linear-gradient(135deg,#4caf50,#81c784);
          color:white;
          cursor:pointer;
          box-shadow:0 4px #388e3c;
          transition: all 0.2s ease;
        }
        .game-btn:hover { background:linear-gradient(135deg,#81c784,#4caf50); }
        .game-btn:active { transform:translateY(2px); box-shadow:0 2px #388e3c; }
     </style>`,
    w => {
      const canvas = w.querySelector("#mineCanvas");
      const ctx = canvas.getContext("2d");
      const mineCountEl = w.querySelector("#mineCount");
      const endMessage = w.querySelector("#endMessage");
      const resultText = w.querySelector("#resultText");
      const resetBtn = w.querySelector("#resetBtn");

      const grid = 50; 
      let field = [];
      let revealed = [];
      let flagged = [];
      let gameOver = false;

      const colors = ["#000","#2196f3","#4caf50","#f44336","#3f51b5","#9c27b0","#009688","#000000"];

      function initField() {
        field = Array.from({length: rows}, () => Array(cols).fill(0));
        revealed = Array.from({length: rows}, () => Array(cols).fill(false));
        flagged = Array.from({length: rows}, () => Array(cols).fill(false));
        gameOver = false;
        endMessage.style.display="none";

        // Coloca minas
        let placed = 0;
        while(placed < minesCount) {
          const r = Math.floor(Math.random()*rows);
          const c = Math.floor(Math.random()*cols);
          if(field[r][c] !== "M") { field[r][c]="M"; placed++; }
        }

        // Conta vizinhos
        for(let r=0;r<rows;r++)
          for(let c=0;c<cols;c++)
            if(field[r][c]!=="M") {
              let count=0;
              for(let i=-1;i<=1;i++)
                for(let j=-1;j<=1;j++)
                  if(r+i>=0 && r+i<rows && c+j>=0 && c+j<cols && field[r+i][c+j]==="M")
                    count++;
              field[r][c]=count;
            }

        drawField();
        mineCountEl.textContent = minesCount;
      }

      function drawCell(r,c) {
        const x = c*grid, y = r*grid;
        ctx.save();
        ctx.translate(x, y);

        // Fundo com anima√ß√£o suave
        const bg = revealed[r][c] ? "#e0f2f1" : "#c8e6c9";
        ctx.fillStyle = bg;
        ctx.shadowColor = "#999";
        ctx.shadowBlur = revealed[r][c] ? 8 : 2;

        // Leve pop animation
        const scale = (revealed[r][c] || flagged[r][c]) ? 1.05 : 1;
        ctx.translate(grid/2, grid/2);
        ctx.scale(scale, scale);
        ctx.translate(-grid/2, -grid/2);

        ctx.fillRect(5,5,grid-10,grid-10);
        ctx.strokeStyle="#aaa";
        ctx.lineWidth=2;
        ctx.strokeRect(5,5,grid-10,grid-10);

        // bandeira
        if(flagged[r][c]){
          ctx.font="32px sans-serif";
          ctx.textAlign="center";
          ctx.textBaseline="middle";
          ctx.fillText("üö©", grid/2, grid/2);
        }

        // n√∫meros
        if(revealed[r][c] && field[r][c]!=="M" && field[r][c]>0){
          ctx.fillStyle = colors[field[r][c]] || "#000";
          ctx.font="28px sans-serif";
          ctx.textAlign="center";
          ctx.textBaseline="middle";
          ctx.fillText(field[r][c], grid/2, grid/2);
        }

        // bomba
        if(revealed[r][c] && field[r][c]==="M"){
          ctx.font="28px sans-serif";
          ctx.textAlign="center";
          ctx.textBaseline="middle";
          ctx.fillText("üí£", grid/2, grid/2);
        }

        ctx.restore();
      }

      function drawField() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(let r=0;r<rows;r++)
          for(let c=0;c<cols;c++)
            drawCell(r,c);
      }

      function revealCell(r,c){
        if(r<0||r>=rows||c<0||c>=cols) return;
        if(revealed[r][c] || flagged[r][c] || gameOver) return;
        revealed[r][c]=true;

        if(field[r][c]==="M"){
          gameOver=true;
          for(let i=0;i<rows;i++)
            for(let j=0;j<cols;j++)
              revealed[i][j]=true;
          drawField();
          showEndMessage("üí• Voc√™ perdeu!");
          return;
        }

        if(field[r][c]===0){
          for(let i=-1;i<=1;i++)
            for(let j=-1;j<=1;j++)
              if(i!==0||j!==0) revealCell(r+i,c+j);
        }

        drawField();
        checkWin();
      }

      function checkWin(){
        let correctFlags = 0;
        let totalFlags = 0;
        for(let r=0;r<rows;r++){
          for(let c=0;c<cols;c++){
            if(flagged[r][c]) totalFlags++;
            if(field[r][c]==="M" && flagged[r][c]) correctFlags++;
            if(field[r][c]!=="M" && flagged[r][c]) return; 
          }
        }
        if(correctFlags===minesCount && totalFlags===minesCount){
          gameOver=true;
          for(let i=0;i<rows;i++)
            for(let j=0;j<cols;j++)
              revealed[i][j]=true;
          drawField();
          showEndMessage("üéâ Voc√™ ganhou!");
        }
      }

      function showEndMessage(msg){
        resultText.textContent=msg;
        endMessage.style.display="block";
      }

      canvas.onmousedown = e => {
        if(gameOver) return;
        const rect = canvas.getBoundingClientRect();
        const x = Math.floor((e.clientX - rect.left)/grid);
        const y = Math.floor((e.clientY - rect.top)/grid);
        if(e.button===2){ 
          flagged[y][x]=!flagged[y][x];
          const flags = flagged.flat().filter(f=>f).length;
          mineCountEl.textContent = minesCount-flags;
          drawCell(y,x);
          checkWin();
        } else { 
          revealCell(y,x);
        }
      };

      canvas.oncontextmenu = e => e.preventDefault();
      resetBtn.onclick = initField;
      initField();
    },
    cols*50 + 20,
    rows*50 + 120
  );
}

/* JOGO: PONG üèì */
function openPong() {
  createWindow("Pong üèì",
    `<div style="text-align:center; font-size:14px; margin-bottom:5px;">
       Player: <span id="playerScore">0</span> - AI: <span id="aiScore">0</span>
     </div>
     <canvas id="pongCanvas" width="400" height="300" style="background:black; display:block; margin:auto;"></canvas>
     <div id="overlay" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
         color:white; text-align:center;"></div>
     <style>
       .pong-btn {
         font-size:20px; 
         padding:10px 20px; 
         background:#1e90ff; 
         color:white; 
         border:none; 
         border-radius:8px; 
         cursor:pointer; 
         transition:0.2s;
         margin:5px;
         animation: pulse 1.5s infinite;
       }
       .pong-btn:hover {
         background:#63b3ff;
         transform: scale(1.1);
       }
       @keyframes pulse {
         0%, 100% { box-shadow: 0 0 5px #1e90ff; }
         50% { box-shadow: 0 0 15px #63b3ff; }
       }
     </style>`,
    w => {
      const canvas = w.querySelector("#pongCanvas");
      const ctx = canvas.getContext("2d");
      const playerScoreEl = w.querySelector("#playerScore");
      const aiScoreEl = w.querySelector("#aiScore");
      const overlay = w.querySelector("#overlay");

      const paddleHeight = 60, paddleWidth = 10, paddleRadius = 5;
      let playerY = canvas.height / 2 - paddleHeight / 2;
      let aiY = canvas.height / 2 - paddleHeight / 2;
      let ballX = canvas.width / 2, ballY = canvas.height / 2, ballRadius = 6;
      let ballSpeedX = 3, ballSpeedY = 3;
      let playerScore = 0, aiScore = 0;
      let gameRunning = false;
      let aiLevel = "medio";

      const hitSound = new Audio("https://www.soundjay.com/button/beep-07.wav");

      let aiOscillation = 0; 
      const particles = []; // part√≠culas

      canvas.onmousemove = e => {
        const rect = canvas.getBoundingClientRect();
        playerY = e.clientY - rect.top - paddleHeight / 2;
        if (playerY < 0) playerY = 0;
        if (playerY > canvas.height - paddleHeight) playerY = canvas.height - paddleHeight;
      };

      function resetBall() {
        ballX = canvas.width / 2;
        ballY = canvas.height / 2;
        const angle = (Math.random() * Math.PI / 4) - Math.PI / 8;
        ballSpeedX = (Math.random() > 0.5 ? 3 : -3);
        ballSpeedY = 3 * Math.sin(angle);
      }

      function drawPaddle(x, y, isAI=false) {
        ctx.fillStyle = "white";
        ctx.beginPath();
        ctx.moveTo(x + paddleRadius, y);
        ctx.lineTo(x + paddleWidth - paddleRadius, y);
        ctx.quadraticCurveTo(x + paddleWidth, y, x + paddleWidth, y + paddleRadius);
        ctx.lineTo(x + paddleWidth, y + paddleHeight - paddleRadius);
        ctx.quadraticCurveTo(x + paddleWidth, y + paddleHeight, x + paddleWidth - paddleRadius, y + paddleHeight);
        ctx.lineTo(x + paddleRadius, y + paddleHeight);
        ctx.quadraticCurveTo(x, y + paddleHeight, x, y + paddleHeight - paddleRadius);
        ctx.lineTo(x, y + paddleRadius);
        ctx.quadraticCurveTo(x, y, x + paddleRadius, y);
        ctx.fill();
      }

      function createParticles(x, y) {
        for (let i = 0; i < 10; i++) {
          particles.push({
            x: x,
            y: y,
            vx: (Math.random() - 0.5) * 3,
            vy: (Math.random() - 0.5) * 3,
            alpha: 1,
            radius: 2 + Math.random() * 2
          });
        }
      }

      function updateParticles() {
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.alpha -= 0.03;
          if (p.alpha <= 0) particles.splice(i, 1);
          else {
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.radius, 0, Math.PI*2);
            ctx.fillStyle = `rgba(255,255,255,${p.alpha})`;
            ctx.fill();
          }
        }
      }

      function endGame(winner) {
        overlay.innerHTML = `<div style="font-size:24px; margin-bottom:10px;">${winner} venceu!</div>
                             <button id="restartBtn" class="pong-btn">Jogar de Novo</button>`;
        overlay.style.display = "block";
        gameRunning = false;

        w.querySelector("#restartBtn").onclick = () => {
          playerScore = 0;
          aiScore = 0;
          playerScoreEl.textContent = playerScore;
          aiScoreEl.textContent = aiScore;
          showStartMenu();
        };
      }

      function updateAI() {
        const aiCenter = aiY + paddleHeight / 2;
        let aiSpeed, errorMargin, errorChance;

        switch(aiLevel) {
          case "facil": aiSpeed = 1.5 + Math.random(); errorMargin=15; errorChance=35; break;
          case "medio": aiSpeed = 2 + Math.random()*1.5; errorMargin=10; errorChance=15; break;
          case "dificil": aiSpeed = 3; errorMargin=5; errorChance=5; break;
        }

        const roll = Math.random() * 100;
        if (roll > errorChance) {
          aiOscillation = Math.sin(Date.now()/200)*2; 
          if (aiCenter < ballY - errorMargin) aiY += aiSpeed + aiOscillation;
          else if (aiCenter > ballY + errorMargin) aiY -= aiSpeed - aiOscillation;
        }

        if(aiY < 0) aiY = 0;
        if(aiY > canvas.height - paddleHeight) aiY = canvas.height - paddleHeight;
      }

      function gameLoop() {
        if(!gameRunning) return;

        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Linha central
        ctx.strokeStyle = "white";
        ctx.setLineDash([5,5]);
        ctx.beginPath();
        ctx.moveTo(canvas.width/2, 0);
        ctx.lineTo(canvas.width/2, canvas.height);
        ctx.stroke();
        ctx.setLineDash([]);

        // Bola normal
        ctx.beginPath();
        ctx.arc(ballX, ballY, ballRadius, 0, Math.PI*2);
        ctx.fillStyle = "white";
        ctx.fill();

        ballX += ballSpeedX;
        ballY += ballSpeedY;

        if(ballY - ballRadius < 0 || ballY + ballRadius > canvas.height) ballSpeedY *= -1;

        // Colis√£o com raquetes
        if (ballX - ballRadius < paddleWidth && ballY > playerY && ballY < playerY + paddleHeight) {
          const collidePoint = ballY - (playerY + paddleHeight/2);
          const angleRad = (Math.PI/4)*(collidePoint/(paddleHeight/2));
          ballSpeedX = Math.abs(ballSpeedX)*1.05;
          ballSpeedY = 3*Math.sin(angleRad);
          createParticles(ballX, ballY); // part√≠culas
          hitSound.play();
        }
        if (ballX + ballRadius > canvas.width - paddleWidth && ballY > aiY && ballY < aiY + paddleHeight) {
          const collidePoint = ballY - (aiY + paddleHeight/2);
          const angleRad = (Math.PI/4)*(collidePoint/(paddleHeight/2));
          ballSpeedX = -Math.abs(ballSpeedX)*1.05;
          ballSpeedY = 3*Math.sin(angleRad);
          createParticles(ballX, ballY);
          hitSound.play();
        }

        if (ballX < 0) { aiScore++; aiScoreEl.textContent = aiScore; resetBall(); ballSpeedX = 3; }
        if (ballX > canvas.width) { playerScore++; playerScoreEl.textContent = playerScore; resetBall(); ballSpeedX = -3; }

        if(playerScore >= 10) return endGame("Voc√™");
        if(aiScore >= 10) return endGame("AI");

        drawPaddle(0, playerY, false);
        drawPaddle(canvas.width - paddleWidth, aiY, true);

        updateAI();
        updateParticles(); // atualiza part√≠culas

        requestAnimationFrame(gameLoop);
      }

      function showStartMenu() {
        overlay.style.display = "block";
        overlay.innerHTML = `
          <div style="font-size:20px; margin-bottom:10px;">Escolha a dificuldade</div>
          <button class="pong-btn" id="easyBtn">F√°cil üü¢</button>
          <button class="pong-btn" id="mediumBtn">M√©dio üü°</button>
          <button class="pong-btn" id="hardBtn">Dif√≠cil üî¥</button>
        `;
        overlay.querySelector("#easyBtn").onclick = () => startGameWithLevel("facil");
        overlay.querySelector("#mediumBtn").onclick = () => startGameWithLevel("medio");
        overlay.querySelector("#hardBtn").onclick = () => startGameWithLevel("dificil");
      }

      function startGameWithLevel(level) {
        aiLevel = level;
        overlay.style.display = "none";
        resetBall();
        ballSpeedX = 3;
        gameRunning = true;
        requestAnimationFrame(gameLoop);
      }

      showStartMenu();
    }
  );
}

</script>

<style>
#fileArea {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  position:relative;
  background:#f0f0f0;
  padding:10px;
  border-radius:6px;
  min-height:300px;
  user-select:none;
}

/* estilo do √≠cone da pasta/nome edit√°vel */
/* √Årea de trabalho */
#desktop .icon span {
  color: white; /* nomes brancos na √°rea de trabalho */
  font-size: 12px;
  text-align: center;
  display: block;
  width: 72px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Explorador de arquivos */
#fileArea .icon span,
#fileArea .icon input {
  color: black; /* nomes pretos no explorador */
  font-size: 12px;
  text-align: center;
  display: block;
  width: 80px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

#fileArea .icon input {
  border: 1px solid #ccc;
  border-radius: 3px;
  background: rgba(255,255,255,0.8);
  padding: 1px 2px;
}

#fileArea .icon input:focus {
  outline: 1px solid #3498db;
  background: white;
}

/* barra de caminho clic√°vel */
#path span {
  cursor:pointer;
  color:#2980b9;
}
#path span + span::before {
  content: " > ";
  color:black;
}

.window .title {
  display: flex;
  justify-content: space-between; /* t√≠tulo √† esquerda, bot√µes √† direita */
  align-items: center;
  padding: 0 8px;
  height: 32px;
  background: #0078d7; /* exemplo de cor */
  color: white;
  font-weight: bold;
  cursor: move;
  user-select: none;
}

.window .title .buttons {
  display: flex;
  gap: 4px; /* espa√ßo entre _ e X */
}

.window .title .min,
.window .title .close {
  cursor: pointer;
  padding: 0 6px;
  font-weight: bold;
}
</style>
</body>
</html>